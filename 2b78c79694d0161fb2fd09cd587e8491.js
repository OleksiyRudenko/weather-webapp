require=function(r,e,n){function t(n,o){function i(r){return t(i.resolve(r))}function f(e){return r[n][1][e]||e}if(!e[n]){if(!r[n]){var c="function"==typeof require&&require;if(!o&&c)return c(n,!0);if(u)return u(n,!0);var l=new Error("Cannot find module '"+n+"'");throw l.code="MODULE_NOT_FOUND",l}i.resolve=f;var s=e[n]=new t.Module(n);r[n][0].call(s.exports,i,s,s.exports)}return e[n].exports}function o(r){this.id=r,this.bundle=t,this.exports={}}var u="function"==typeof require&&require;t.isParcelRequire=!0,t.Module=o,t.modules=r,t.cache=e,t.parent=u;for(var i=0;i<n.length;i++)t(n[i]);return t}({49:[function(require,module,exports) {
module.exports="963dd36bc9f864db9ad3014a2e90c1f7.jpg";
},{}],50:[function(require,module,exports) {
module.exports="8a0be4f980743221dd3d5ed76e0d866d.jpg";
},{}],78:[function(require,module,exports) {
module.exports="dee2af502506d7bf02b91e505c99043d.jpg";
},{}],51:[function(require,module,exports) {
module.exports="fb8d4f164be496bfcbf620c3279ce159.jpg";
},{}],52:[function(require,module,exports) {
module.exports="d0309dff09bd58f15292c19f27ffe63b.jpg";
},{}],55:[function(require,module,exports) {
module.exports="9abff02a7bbaedd84291a2629181b959.jpg";
},{}],53:[function(require,module,exports) {
module.exports="14679635a1824e93bd87213972bacdcb.jpg";
},{}],54:[function(require,module,exports) {
module.exports="f719a6959001ddafa86ac8466696a0d3.jpg";
},{}],56:[function(require,module,exports) {
module.exports="3aa4edc15a41bd926c0a47d573af411d.jpg";
},{}],57:[function(require,module,exports) {
module.exports="2846a9179d6671c766d89d7195be4005.jpg";
},{}],58:[function(require,module,exports) {
module.exports="362f91b5803ea0f845a4f0ace17bf7e0.jpg";
},{}],59:[function(require,module,exports) {
module.exports="99a08edbf574e8b16e42017f73480b1c.jpg";
},{}],60:[function(require,module,exports) {
module.exports="1071bb3063c7726d8578da1b0de1ad94.jpg";
},{}],61:[function(require,module,exports) {
module.exports="3ce4fe8f99c94f72f45786b07abea9f5.jpg";
},{}],73:[function(require,module,exports) {
module.exports="e7a54f8eb83d49a9397922aac52f5b60.jpg";
},{}],62:[function(require,module,exports) {
module.exports="0421e2900a96d6d6cccc3accd0e3ea09.jpg";
},{}],63:[function(require,module,exports) {
module.exports="e7b4a4c9d4426eeee5e928cad8a01d0c.jpg";
},{}],64:[function(require,module,exports) {
module.exports="2452a9665c98ba4410f5e9caafaf8683.jpg";
},{}],65:[function(require,module,exports) {
module.exports="138f0afe9c4d72d6dbaa642883e8e914.jpg";
},{}],66:[function(require,module,exports) {
module.exports="5831bff4c3d0cc267227257db709d5c9.jpg";
},{}],67:[function(require,module,exports) {
module.exports="108602a51ac9e69aec864a71e6cd1b5f.jpg";
},{}],69:[function(require,module,exports) {
module.exports="1ba8d469aef93da719484fbe4000717a.jpg";
},{}],68:[function(require,module,exports) {
module.exports="61a9b61c0273c59eb0ffebcd0f18a0ea.jpg";
},{}],70:[function(require,module,exports) {
module.exports="434c7ff1de708d26ab750b2bb0a454c6.jpg";
},{}],71:[function(require,module,exports) {
module.exports="bab78e869d1fa81c5ad275879ea31f7b.jpg";
},{}],72:[function(require,module,exports) {
module.exports="5444a5087ba80013d3246230e30379cb.jpg";
},{}],74:[function(require,module,exports) {
module.exports="3cb39d06d078ad7dd0657746d4262c1b.jpg";
},{}],75:[function(require,module,exports) {
module.exports="fe5b04d49f23c48fe958a4af596d2499.jpg";
},{}],76:[function(require,module,exports) {
module.exports="7b51cb656dd8acebc933cbc518be8844.jpg";
},{}],77:[function(require,module,exports) {
module.exports="8e398bed18d0e2106ada96afd9ce65d3.jpeg";
},{}],48:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.moodImagery=void 0;var e=require("./w-brokenClouds-day-autumn-1.jpg"),r=we(e),u=require("./w-brokenClouds-day-summer-1.jpg"),d=we(u),t=require("./w-brokenClouds-night-summer-1.jpg"),a=we(t),w=require("./w-clearSky-day-autumn-1.jpg"),i=we(w),n=require("./w-clearSky-day-summer-1.jpg"),s=we(n),l=require("./w-clearSky-day-winter-1.jpg"),g=we(l),m=require("./w-clearSky-night-autumn-1.jpg"),p=we(m),S=require("./w-clearSky-night-summer-1.jpg"),f=we(S),j=require("./w-clearSky-night-winter-1.jpg"),o=we(j),q=require("./w-mist-day-autumn-1.jpg"),y=we(q),C=require("./w-mist-day-winter-1.jpg"),h=we(C),c=require("./w-mist-night-summer-1.jpg"),W=we(c),k=require("./w-mist-night-winter-1.jpg"),A=we(k),M=require("./w-rain-day-autumn-1.jpg"),R=we(M),T=require("./w-rain-day-spring-1.jpg"),b=we(T),v=require("./w-rain-day-summer-1.jpg"),_=we(v),x=require("./w-rain-day-winter-1.jpg"),B=we(x),G=require("./w-rain-night-summer-1.jpg"),I=we(G),O=require("./w-scatteredClouds-day-summer-1.jpg"),P=we(O),U=require("./w-scatteredClouds-day-winter-1.jpg"),z=we(U),D=require("./w-snow-day-autumn-1.jpg"),E=we(D),F=require("./w-snow-day-winter-1.jpg"),H=we(F),J=require("./w-snow-night-winter-1.jpg"),K=we(J),L=require("./w-thunderstorm-day-summer-1.jpg"),N=we(L),Q=require("./w-thunderstorm-day-winter-1.jpg"),V=we(Q),X=require("./w-thunderstorm-night-summer-1.jpg"),Y=we(X),Z=require("./season-autumn.jpg"),$=we(Z),ee=require("./season-spring.jpg"),re=we(ee),ue=require("./season-summer.jpg"),de=we(ue),te=require("./season-winter.jpeg"),ae=we(te);function we(e){return e&&e.__esModule?e:{default:e}}var ie=exports.moodImagery={wBCdA1:r.default,wBCdS1:d.default,wBCnS1:a.default,wCSdA1:i.default,wCSdS1:s.default,wCSdW1:g.default,wCSnA1:p.default,wCSnS1:f.default,wCSnW1:o.default,wMdA1:y.default,wMdW1:h.default,wMnS1:W.default,wMnW1:A.default,wRdA1:R.default,wRdSG1:b.default,wRdS1:_.default,wRdW1:B.default,wRnS1:I.default,wSCdS1:P.default,wSCdW1:z.default,wSRdS1:I.default,wSdA1:E.default,wSdW1:H.default,wSnW1:K.default,wTSdS1:N.default,wTSdW1:V.default,wTSnS1:Y.default,sAT:$.default,sSG:re.default,sSU:de.default,sWT:ae.default};
},{"./w-brokenClouds-day-autumn-1.jpg":49,"./w-brokenClouds-day-summer-1.jpg":50,"./w-brokenClouds-night-summer-1.jpg":78,"./w-clearSky-day-autumn-1.jpg":51,"./w-clearSky-day-summer-1.jpg":52,"./w-clearSky-day-winter-1.jpg":55,"./w-clearSky-night-autumn-1.jpg":53,"./w-clearSky-night-summer-1.jpg":54,"./w-clearSky-night-winter-1.jpg":56,"./w-mist-day-autumn-1.jpg":57,"./w-mist-day-winter-1.jpg":58,"./w-mist-night-summer-1.jpg":59,"./w-mist-night-winter-1.jpg":60,"./w-rain-day-autumn-1.jpg":61,"./w-rain-day-spring-1.jpg":73,"./w-rain-day-summer-1.jpg":62,"./w-rain-day-winter-1.jpg":63,"./w-rain-night-summer-1.jpg":64,"./w-scatteredClouds-day-summer-1.jpg":65,"./w-scatteredClouds-day-winter-1.jpg":66,"./w-snow-day-autumn-1.jpg":67,"./w-snow-day-winter-1.jpg":69,"./w-snow-night-winter-1.jpg":68,"./w-thunderstorm-day-summer-1.jpg":70,"./w-thunderstorm-day-winter-1.jpg":71,"./w-thunderstorm-night-summer-1.jpg":72,"./season-autumn.jpg":74,"./season-spring.jpg":75,"./season-summer.jpg":76,"./season-winter.jpeg":77}],45:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("../assets/mood/imagery/moodimagery.js");Object.defineProperty(exports,"moodImagery",{enumerable:!0,get:function(){return e.moodImagery}});
},{"../assets/mood/imagery/moodimagery.js":48}],23:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.appConfig=void 0;var e=require("./assets.js"),o=exports.appConfig={config:{baseUrl:window.location.protocol+"//"+window.location.host+window.location.pathname.split("/").slice(0,-1).join("/")+"/",cityList:"assets/city.list.json",historyInitialSet:[{name:"Kyiv,UA",nameUC:"KYIV,UA",lastQueried:+new Date},{name:"London,UK",nameUC:"LONDON,UK",lastQueried:+new Date},{name:"Odessa,UA",nameUC:"ODESSA,UA",lastQueried:+new Date},{name:"Odessa,US",nameUC:"ODESSA,US",lastQueried:+new Date}],api:{apiUrl:"https://api.openweathermap.org/data/2.5/",apiEndpoint:{current:{cityname:{path:"weather",params:["q"]},latlon:{path:"weather",params:["lat","lon"]}},forecast5:{cityname:{path:"forecast",params:["q"]},latlon:{path:"weather",params:["lat","lon"]}}},apiKey:"0f034f0e9216aaa8ed94c3d87af01e18",apiParamName:"APPID",iconUrl:"https://openweathermap.org/img/w/",iconExt:".png"},storage:{dbName:"weatherapp-rdnk",dbVersion:1,store:[[{storeName:"settings",storeOptions:{keyPath:"option"},fields:["option","value"]},{storeName:"cities",storeOptions:{keyPath:"id"},fields:["id","name","nameUC"],index:[["nameUC"]]},{storeName:"favcity",storeOptions:{keyPath:"name"},fields:["name","nameUC"],index:[["nameUC"]]},{storeName:"cityhistory",storeOptions:{keyPath:"name"},fields:["name","nameUC","lastQueried"],index:[["nameUC"]]}]]},icons:{day:{brokenClouds:"wi-day-cloudy",clearSky:"wi-day-sunny",fewClouds:"wi-day-cloudy",mist:"wi-day-fog",rain:"wi-day-rain",scatteredClouds:"wi-day-cloudy-high",showerRain:"wi-day-showers",snow:"wi-day-snow-wind",thunderStorm:"wi-day-thunderstorm",alien:"wi-alien"},night:{brokenClouds:"wi-night-cloudy",clearSky:"wi-night-clear",fewClouds:"wi-night-cloudy",mist:"wi-night-fog",rain:"wi-night-alt-rain",scatteredClouds:"wi-night-alt-cloudy-high",showerRain:"wi-night-alt-showers",snow:"wi-night-alt-snow-wind",thunderStorm:"wi-night-alt-thunderstorm",alien:"wi-alien"}},mood:{seasons:{spring:e.moodImagery.sSG,summer:e.moodImagery.sSU,autumn:e.moodImagery.sAT,winter:e.moodImagery.sWT},imagery:{brokenClouds:{day:{autumn:e.moodImagery.wBCdA1,spring:e.moodImagery.wBCdS1,summer:e.moodImagery.wBCdS1,winter:e.moodImagery.wBCdA1},night:{autumn:e.moodImagery.wBCnS1,spring:e.moodImagery.wBCnS1,summer:e.moodImagery.wBCnS1,winter:e.moodImagery.wBCnS1}},clearSky:{day:{autumn:e.moodImagery.wCSdA1,spring:e.moodImagery.wCSdS1,summer:e.moodImagery.wCSdS1,winter:e.moodImagery.wCSdW1},night:{autumn:e.moodImagery.wCSnA1,spring:e.moodImagery.wCSnS1,summer:e.moodImagery.wCSnS1,winter:e.moodImagery.wCSnW1}},mist:{day:{autumn:e.moodImagery.wMdA1,spring:e.moodImagery.wMdA1,summer:e.moodImagery.wMdA1,winter:e.moodImagery.wMdW1},night:{autumn:e.moodImagery.wMnS1,spring:e.moodImagery.wMnS1,summer:e.moodImagery.wMnS1,winter:e.moodImagery.wMnW1}},rain:{day:{autumn:e.moodImagery.wRdA1,spring:e.moodImagery.wRdSG1,summer:e.moodImagery.wRdS1,winter:e.moodImagery.wRdW1},night:{autumn:e.moodImagery.wRnS1,spring:e.moodImagery.wRnS1,summer:e.moodImagery.wRnS1,winter:e.moodImagery.wRnS1}},fewClouds:{day:{autumn:e.moodImagery.wSCdS1,spring:e.moodImagery.wSCdS1,summer:e.moodImagery.wSCdS1,winter:e.moodImagery.wSCdW1},night:{autumn:e.moodImagery.wBCnS1,spring:e.moodImagery.wBCnS1,summer:e.moodImagery.wBCnS1,winter:e.moodImagery.wBCnS1}},scatteredClouds:{day:{autumn:e.moodImagery.wSCdS1,spring:e.moodImagery.wSCdS1,summer:e.moodImagery.wSCdS1,winter:e.moodImagery.wSCdW1},night:{autumn:e.moodImagery.wBCnS1,spring:e.moodImagery.wBCnS1,summer:e.moodImagery.wBCnS1,winter:e.moodImagery.wBCnS1}},showerRain:{day:{autumn:e.moodImagery.wSRdS1,spring:e.moodImagery.wSRdS1,summer:e.moodImagery.wSRdS1,winter:e.moodImagery.wRdW1},night:{autumn:e.moodImagery.wRnS1,spring:e.moodImagery.wRnS1,summer:e.moodImagery.wRnS1,winter:e.moodImagery.wRnS1}},snow:{day:{autumn:e.moodImagery.wSdA1,spring:e.moodImagery.wSdA1,summer:e.moodImagery.wSdA1,winter:e.moodImagery.wSdW1},night:{autumn:e.moodImagery.wSnW1,spring:e.moodImagery.wSnW1,summer:e.moodImagery.wSnW1,winter:e.moodImagery.wSnW1}},thunderStorm:{day:{autumn:e.moodImagery.wTSdS1,spring:e.moodImagery.wTSdS1,summer:e.moodImagery.wTSdS1,winter:e.moodImagery.wTSdW1},night:{autumn:e.moodImagery.wTSnS1,spring:e.moodImagery.wTSnS1,summer:e.moodImagery.wTSnS1,winter:e.moodImagery.wTSnS1}}}},guide:{playOrder:["userInput","unitSwitch","manageFavourite"],tipOptions:{placement:"bottom",animation:"shift-toward",inertia:!0,duration:300,arrow:!0,delay:[200,1e3],size:"large",theme:"outstanding",createPopperInstanceOnInit:!0},onloadDelay:1500,exposureDuration:2500}},uiElements:{UnitSwitchController:{container:"unit-switch"},ProgressController:{container:"progress-notification",action:"progress-action",count:"progress-count",countUnit:"progress-count-unit",ofConjunction:"progress-of",total:"progress-total",totalUnit:"progress-total-unit"},CityInputController:{container:"search-bar",gps:"gps",favNo:"favourite-no",favYes:"favourite-yes",favDropDown:"favourite-dropdown",textInput:"search-input",searchAction:"search-action"},SearchHistoryController:{container:"history-container",textInput:"search-input"},WeatherController:{container:"weather-container",todayMain:"weather-today-main",todayDebug:"weather-today-debug",todayError:"weather-today-error",todaySpinner:"weather-today-spinner",forecastMain:"weather-forecast-main",forecastDebug:"weather-forecast-debug",forecastError:"weather-forecast-error",forecastSpinner:"weather-forecast-spinner"},MoodController:{container:"body"},GuideController:{userInput:"search-input",unitSwitch:"unit-switch",manageFavourite:"favourite-no"},FavCityController:{addFavCity:"favourite-no",removeFavCity:"favourite-yes",cityFullName:"wt-cityFull"}}};
},{"./assets.js":45}],42:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(n,t,o){return t&&e(n.prototype,t),o&&e(n,o),n}}();function n(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var t=function(){function t(){n(this,t),this.config={},this.dependencies={Services:{},Controllers:{},UiControllers:{}}}return e(t,[{key:"runRoot",value:function(){}},{key:"run",value:function(){}},{key:"getConfig",value:function(){return this.config}},{key:"setConfig",value:function(e){this.config=e}},{key:"getDependencies",value:function(){return this.dependencies}},{key:"setDependencies",value:function(e){this.dependencies=e}},{key:"debugThisClassName",value:function(e){console.log(this.__proto__.constructor.name+"::"+e)}}]),t}();exports.default=t;
},{}],26:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./appcomponent.js"),t=o(e);function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=function(e){function o(){return r(this,o),n(this,(o.__proto__||Object.getPrototypeOf(o)).call(this))}return u(o,t.default),o}();exports.default=i;
},{"./appcomponent.js":42}],25:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t=exports.isPlainObject=function(t){if("object"===(void 0===t?"undefined":e(t))&&null!==t){if("function"==typeof Object.getPrototypeOf){var n=Object.getPrototypeOf(t);return n===Object.prototype||null===n}return"[object Object]"===Object.prototype.toString.call(t)}return!1},n=exports.attachOnClickEvent=function(e,t,n){e.onclick=t.bind(n),e.ontouchstart=t.bind(n)},o=exports.elementIdsToHtmlElements=function(e,t){return t||(t=Object.keys(e)),t.reduce(function(t,n){return t[n]=document.getElementById(e[n]),t},{})},r=exports.objectKeysToHtmlElements=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return n||(n=Object.keys(e)),n.reduce(function(e,n){var o=document.getElementById(t+n);return o&&(e[n]=o),e},{})},c=exports.sanitizeWhitespaces=function(e,t){return e=(e=e.replace(/\s\s+/g," ")).replace(/^\s/,""),t&&(e=e.replace(/\s$/,"")),e},i=exports.getCaretPosition=function(e){var t=0;if(document.selection){oField.focus();var n=document.selection.createRange();n.moveStart("character",-oField.value.length),t=n.text.length}else(e.selectionStart||"0"==e.selectionStart)&&(t="backward"===e.selectionDirection?e.selectionStart:e.selectionEnd);return t},s=exports.setCaretPosition=function(e,t){if(e)if(e.createTextRange){var n=e.createTextRange();n.move("character",t),n.select()}else e.selectionStart?(e.focus(),e.setSelectionRange(t,t)):e.focus()},l=exports.traverseObjectAndChange=function e(n,o){var r={};return Object.keys(n).forEach(function(c,i){t(n[c])?r[c]=e(n[c],o):r[c]=o(n[c],c)}),r};
},{}],43:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),t=require("./appcontrollercomponent.js"),n=r(t);function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(t){function r(){o(this,r);var e=i(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return e.uiElements={},e}return u(r,n.default),e(r,[{key:"getUiElements",value:function(){return this.uiElements}},{key:"setUiElements",value:function(e){this.uiElements=e}},{key:"attachOnClickHandler",value:function(e,t){e.addEventListener("click",t.bind(this)),e.addEventListener("touchstart",t.bind(this))}}]),r}();exports.default=a;
},{"./appcontrollercomponent.js":26}],47:[function(require,module,exports) {
"use strict";!function(){function e(e){return new Promise(function(t,n){e.onsuccess=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function t(t,n,o){var r,i=new Promise(function(i,u){e(r=t[n].apply(t,o)).then(i,u)});return i.request=r,i}function n(e,t,n){n.forEach(function(n){Object.defineProperty(e.prototype,n,{get:function(){return this[t][n]},set:function(e){this[t][n]=e}})})}function o(e,n,o,r){r.forEach(function(r){r in o.prototype&&(e.prototype[r]=function(){return t(this[n],r,arguments)})})}function r(e,t,n,o){o.forEach(function(o){o in n.prototype&&(e.prototype[o]=function(){return this[t][o].apply(this[t],arguments)})})}function i(e,n,o,r){r.forEach(function(r){r in o.prototype&&(e.prototype[r]=function(){return e=this[n],(o=t(e,r,arguments)).then(function(e){if(e)return new c(e,o.request)});var e,o})})}function u(e){this._index=e}function c(e,t){this._cursor=e,this._request=t}function s(e){this._store=e}function a(e){this._tx=e,this.complete=new Promise(function(t,n){e.oncomplete=function(){t()},e.onerror=function(){n(e.error)},e.onabort=function(){n(e.error)}})}function p(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new a(n)}function f(e){this._db=e}n(u,"_index",["name","keyPath","multiEntry","unique"]),o(u,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),i(u,"_index",IDBIndex,["openCursor","openKeyCursor"]),n(c,"_cursor",["direction","key","primaryKey","value"]),o(c,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(t){t in IDBCursor.prototype&&(c.prototype[t]=function(){var n=this,o=arguments;return Promise.resolve().then(function(){return n._cursor[t].apply(n._cursor,o),e(n._request).then(function(e){if(e)return new c(e,n._request)})})})}),s.prototype.createIndex=function(){return new u(this._store.createIndex.apply(this._store,arguments))},s.prototype.index=function(){return new u(this._store.index.apply(this._store,arguments))},n(s,"_store",["name","keyPath","indexNames","autoIncrement"]),o(s,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),i(s,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),r(s,"_store",IDBObjectStore,["deleteIndex"]),a.prototype.objectStore=function(){return new s(this._tx.objectStore.apply(this._tx,arguments))},n(a,"_tx",["objectStoreNames","mode"]),r(a,"_tx",IDBTransaction,["abort"]),p.prototype.createObjectStore=function(){return new s(this._db.createObjectStore.apply(this._db,arguments))},n(p,"_db",["name","version","objectStoreNames"]),r(p,"_db",IDBDatabase,["deleteObjectStore","close"]),f.prototype.transaction=function(){return new a(this._db.transaction.apply(this._db,arguments))},n(f,"_db",["name","version","objectStoreNames"]),r(f,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(e){[s,u].forEach(function(t){t.prototype[e.replace("open","iterate")]=function(){var t,n=(t=arguments,Array.prototype.slice.call(t)),o=n[n.length-1],r=this._store||this._index,i=r[e].apply(r,n.slice(0,-1));i.onsuccess=function(){o(i.result)}}})}),[u,s].forEach(function(e){e.prototype.getAll||(e.prototype.getAll=function(e,t){var n=this,o=[];return new Promise(function(r){n.iterateCursor(e,function(e){e?(o.push(e.value),void 0===t||o.length!=t?e.continue():r(o)):r(o)})})})});var d={open:function(e,n,o){var r=t(indexedDB,"open",[e,n]),i=r.request;return i.onupgradeneeded=function(e){o&&o(new p(i.result,e.oldVersion,i.transaction))},r.then(function(e){return new f(e)})},delete:function(e){return t(indexedDB,"deleteDatabase",[e])}};"undefined"!=typeof module?(module.exports=d,module.exports.default=module.exports):self.idb=d}();
},{}],46:[function(require,module,exports) {
"undefined"!=typeof indexedDB?module.exports=require("./idb.js"):module.exports={open:function(){return Promise.reject("IDB requires a browser environment")},delete:function(){return Promise.reject("IDB requires a browser environment")}};
},{"./idb.js":47}],28:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),e=require("../framework/appuicontrollercomponent.js"),n=o(e);function o(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function u(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(e){function o(){i(this,o);var t=r(this,(o.__proto__||Object.getPrototypeOf(o)).call(this));return t.config={},t.dependencies={},t._count=0,t._total=0,t}return u(o,n.default),t(o,[{key:"show",value:function(t,e,n){t&&(this.uiElements.action.innerText=t+": "),this._count=0,this.uiElements.count.innerText="0",this.uiElements.countUnit.innerText=e,this._total=n,n&&(this.uiElements.ofConjunction.innerText=" of ")&&(this.uiElements.total.innerText=n)&&(this.uiElements.totalUnit.innerText=e),this.uiElements.container.classList.add("display-block")}},{key:"hide",value:function(t){var e=this;setTimeout(function(){e.uiElements.container.classList.remove("display-block")},t)}},{key:"setCount",value:function(t){this._count=t<0||t>this._total?this._total:t,this.uiElements.count.innerText=this._count}},{key:"addCount",value:function(t){this._count+=t,this._total&&this._count>this._total&&(this._count=this._total),this.uiElements.count.innerText=this._count}}]),o}();exports.default=s;
},{"../framework/appuicontrollercomponent.js":43}],33:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,r,o){return r&&e(t.prototype,r),o&&e(t,o),t}}(),t=function e(t,r,o){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,r);if(void 0===n){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,r,o)}if("value"in n)return n.value;var s=n.get;return void 0!==s?s.call(o):void 0},r=require("../../../node_modules/idb/lib/node.js"),o=c(r),n=require("../framework/appservicecomponent.js"),i=c(n),s=require("../controller/progresscontroller.js"),u=c(s);function c(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var d=function(r){function n(){l(this,n);var e=a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.config={storage:"storage"},e.dependencies={UiControllers:{ProgressController:"ProgressController"}},e}return f(n,i.default),e(n,[{key:"runRoot",value:function(){t(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"runRoot",this).call(this),this._dbPromise=this.dbOpen(this.config.storage.dbVersion),this.logSummary()}},{key:"put",value:function(e,t){var r=this;Array.isArray(t)||(t=[t]);var o=t.length,n=o<=100?10:o<=1e3?20:100;return o>20&&this.dependencies.UiControllers.ProgressController.show("Adding records to "+e,"",o),this._dbPromise.then(function(i){var s=i.transaction(e,"readwrite"),u=s.objectStore(e);return Promise.all(t.map(function(e,t){return t%n||r.dependencies.UiControllers.ProgressController.addCount(n),u.put(e)})).catch(function(e){r.dependencies.UiControllers.ProgressController.hide(100),s.abort(),console.log(e)}).then(function(){r.dependencies.UiControllers.ProgressController.setCount(o),r.dependencies.UiControllers.ProgressController.hide(2500)})})}},{key:"delete",value:function(e,t){return this._dbPromise.then(function(r){return r.transaction(e,"readwrite").objectStore(e).delete(t)})}},{key:"getAll",value:function(e,t,r){return this._dbPromise.then(function(o){var n=o.transaction(e,"readonly").objectStore(e),i=n;return t&&(i=n.index(t)),i.getAll(r)})}},{key:"get",value:function(e,t,r){return this._dbPromise.then(function(o){var n=o.transaction(e,"readonly").objectStore(e),i=n;return t&&(i=n.index(t)),i.get(r)})}},{key:"dbOpen",value:function(e){var t=this;return o.default.open(this.config.storage.dbName,e,function(e){for(var r=t.config.storage.store,o=0;o<=e.oldVersion;o++)r[o].forEach(function(t){var r=e.createObjectStore(t.storeName,t.storeOptions);t.index&&t.index.forEach(function(e){r.createIndex(e[0],e[e.length-1])})})})}},{key:"storeCount",value:function(e){return this._dbPromise.then(function(t){return t.transaction(e,"readonly").objectStore(e).count()}).catch(function(e){return e})}},{key:"logSummary",value:function(){var e=this;[].concat.apply([],this.config.storage.store).map(function(e){return e.storeName}).forEach(function(t){e.storeCount(t).then(function(e){console.log(t+".length == "+e)}).catch(function(e){console.log(e)})})}}]),n}();exports.default=d;
},{"../../../node_modules/idb/lib/node.js":46,"../framework/appservicecomponent.js":26,"../controller/progresscontroller.js":28}],32:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),t=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var s=r.get;return void 0!==s?s.call(i):void 0},n=require("../framework/appservicecomponent.js"),i=s(n),r=require("./storageservice.js"),o=s(r);function s(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var p=function(n){function r(){u(this,r);var e=c(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return e.dependencies={Services:{StorageService:"StorageService"}},e._storeName="settings",e._settings={Units:"imperial"},e._units={windSpeed:{metric:"m/s",imperial:"mph"}},e}return a(r,i.default),e(r,[{key:"run",value:function(){t(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"run",this).call(this),this.settingsPromise=this.loadSettings()}},{key:"setImperial",value:function(){this._settings.Units="imperial"}},{key:"setMetric",value:function(){this._settings.Units="metric"}},{key:"switchUnits",value:function(){this._settings.Units="metric"===this._settings.Units?"imperial":"metric",this.updateStorage()}},{key:"updateStorage",value:function(){var e={option:"Units",value:this._settings.Units};this.dependencies.Services.StorageService.put(this._storeName,e).then(function(){console.log("Settings store updated")})}},{key:"loadSettings",value:function(){var e=this;return this.dependencies.Services.StorageService.storeCount(this._storeName).then(function(t){t||e.updateStorage()}),this.dependencies.Services.StorageService.getAll(this._storeName).then(function(t){return t.forEach(function(t){return e._settings[t.option]=t.value}),new Promise(function(t,n){return t(e._settings)})})}},{key:"units",get:function(){return this._settings.Units}},{key:"windSpeedUnits",get:function(){return this._units.windSpeed[this._settings.Units]}}]),r}();exports.default=p;
},{"../framework/appservicecomponent.js":26,"./storageservice.js":33}],27:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),t=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var c=i.get;return void 0!==c?c.call(r):void 0},n=require("./../framework/appuicontrollercomponent.js"),r=c(n),i=require("./../service/settingsservice.js"),o=c(i);function c(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(n){function i(){s(this,i);var e=l(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return e.config={},e.dependencies={Services:{SettingsService:"SettingsService"},UiControllers:{CityInputController:"CityInputController"}},e}return u(i,r.default),e(i,[{key:"run",value:function(){t(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"run",this).call(this),this.attachOnClickHandler(this.uiElements.container,this.onClick),this.render()}},{key:"onClick",value:function(e){this.dependencies.Services.SettingsService.switchUnits();var t=this.uiElements.container.children,n=!0,r=!1,i=void 0;try{for(var o,c=t[Symbol.iterator]();!(n=(o=c.next()).done);n=!0){o.value.classList.toggle("unit-active")}}catch(e){r=!0,i=e}finally{try{!n&&c.return&&c.return()}finally{if(r)throw i}}this.dependencies.UiControllers.CityInputController.actionSearch(),this.dependencies.UiControllers.CityInputController.focus()}},{key:"render",value:function(){var e=this;this.dependencies.Services.SettingsService.settingsPromise.then(function(t){var n=e.dependencies.Services.SettingsService.units,r=e.uiElements.container.children,i=r[0],o=r[1];if("imperial"===n){var c=[i,o];o=c[0],i=c[1]}i.classList.add("unit-active"),o.classList.remove("unit-active")})}}]),i}();exports.default=a;
},{"./../framework/appuicontrollercomponent.js":43,"./../service/settingsservice.js":32}],41:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),t=function e(t,r,n){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,r);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,r,n)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(n):void 0},r=require("../framework/appservicecomponent.js"),n=a(r),o=require("./storageservice.js"),i=a(o);function a(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(r){function o(){u(this,o);var e=c(this,(o.__proto__||Object.getPrototypeOf(o)).call(this));return e.config={historyInitialSet:"historyInitialSet"},e.dependencies={Services:{StorageService:"StorageService"}},e._storeName="cityhistory",e}return s(o,n.default),e(o,[{key:"run",value:function(){t(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"run",this).call(this),this.updateStorage()}},{key:"addEntry",value:function(e){e.lastQueried=+new Date,e.nameUC=e.name.toUpperCase(),this.dependencies.Services.StorageService.put(this._storeName,e)}},{key:"getItems",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;return this.dependencies.Services.StorageService.getAll(this._storeName).then(function(t){return t.sort(function(e,t){return t.lastQueried-e.lastQueried}),(t=t.slice(0,e).map(function(e){return e.name})).sort(),t})}},{key:"updateStorage",value:function(){var e=this;this.dependencies.Services.StorageService.storeCount(this._storeName).then(function(t){t||e.dependencies.Services.StorageService.put(e._storeName,e.config.historyInitialSet)})}}]),o}();exports.default=l;
},{"../framework/appservicecomponent.js":26,"./storageservice.js":33}],30:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),t=function e(t,r,n){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,r);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,r,n)}if("value"in o)return o.value;var u=o.get;return void 0!==u?u.call(n):void 0},r=require("../framework/appservicecomponent.js"),n=u(r),o=require("./storageservice.js"),i=u(o);function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(r){function o(){c(this,o);var e=a(this,(o.__proto__||Object.getPrototypeOf(o)).call(this));return e.dependencies={Services:{StorageService:"StorageService"}},e._storeName="favcity",e}return s(o,n.default),e(o,[{key:"run",value:function(){t(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"run",this).call(this)}},{key:"addEntry",value:function(e){return e.nameUC=e.name.toUpperCase(),this.dependencies.Services.StorageService.put(this._storeName,e)}},{key:"deleteEntry",value:function(e){return this.dependencies.Services.StorageService.delete(this._storeName,e)}},{key:"getItems",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:20;return this.dependencies.Services.StorageService.getAll(this._storeName).then(function(t){return t.sort(function(e,t){return t.nameUC>e.nameUC}),(t=t.slice(0,e).map(function(e){return e.name})).sort(),t})}},{key:"getItem",value:function(e){return this.dependencies.Services.StorageService.get(this._storeName,"",e)}}]),o}();exports.default=l;
},{"../framework/appservicecomponent.js":26,"./storageservice.js":33}],34:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),t=function e(t,i,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,i);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,n)}if("value"in r)return r.value;var c=r.get;return void 0!==c?c.call(n):void 0},i=require("../framework/appuicontrollercomponent.js"),n=u(i),r=require("../service/cityhistoryservice.js"),o=u(r),c=require("./cityinputcontroller.js"),s=u(c),l=require("../service/favcityservice.js"),a=u(l);function u(e){return e&&e.__esModule?e:{default:e}}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var p=function(i){function r(){v(this,r);var e=d(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return e.config={},e.dependencies={Services:{CityHistoryService:"CityHistoryService",FavCityService:"FavCityService"},UiControllers:{CityInputController:"CityInputController"}},e.uiElements.firstListItem=null,e._isActive=!1,e}return f(r,n.default),e(r,[{key:"run",value:function(){t(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"run",this).call(this),this.attachOnClickHandler(this.uiElements.container,this.onClick)}},{key:"show",value:function(){var e=this;return Promise.all([this.getFavourites(),this.getHistory()]).then(function(t){e.uiElements.container.innerHTML="";var i=["star","history"],n=[];return t.forEach(function(e,t){e.forEach(function(e){n.find(function(t){return t.value===e})||n.push({value:e,icon:i[t]})})}),n.forEach(function(t,i){e.uiElements.container.appendChild(e.renderEntry(i,t.value,t.icon))}),e.uiElements.container.classList.add("city-container-visible"),e.uiElements.firstListItem=document.getElementById("city-list-element-0"),!0})}},{key:"hide",value:function(){this._isActive=!1,this.uiElements.container.classList.remove("city-container-visible")}},{key:"focus",value:function(){this.debugThisClassName("focus"),this.uiElements.firstListItem.focus()}},{key:"onClick",value:function(e){e.target;var t=e.clientX&&e.clientY?e.target.getAttribute("data-value"):e.target.value;this._isActive=!1,e.clientX&&e.clientY&&(e.preventDefault(),this.uiElements.container.classList.remove("city-container-visible"),this.dependencies.UiControllers.CityInputController.setValue(t))}},{key:"renderEntry",value:function(e,t){var i=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=document.createElement("input");r.id="city-list-element-"+e,r.setAttribute("type","radio"),r.setAttribute("name","city-list"),r.setAttribute("value",t),r.classList.add("city-list-radio"),e||r.setAttribute("checked",""),r.addEventListener("keydown",function(e){switch(e.keyCode){case 13:e.preventDefault(),i.uiElements.container.classList.remove("city-container-visible"),i.dependencies.UiControllers.CityInputController.setValue(e.target.value);break;case 27:i.hide(),i.dependencies.UiControllers.CityInputController.focus()}});var o=null;if(n){(o=document.createElement("i")).classList.add("material-icons");var c=document.createAttribute("data-value");c.value=t,o.setAttributeNode(c),o.innerHTML=n}var s=document.createTextNode(t),l=document.createElement("div");l.classList.add("city-list-element");var a=document.createAttribute("data-value");a.value=t,l.setAttributeNode(a),l.setAttribute("data-value",t),o&&l.appendChild(o),l.appendChild(s),l.addEventListener("hover",function(e){console.log("HOVER on"),console.log(e),console.log(e.target)});var u=document.createElement("label");u.setAttribute("for","city-list-element-"+e),u.appendChild(r),u.appendChild(l);var v=document.createElement("div");return v.appendChild(u),v}},{key:"getFavourites",value:function(){return this.dependencies.Services.FavCityService.getItems()}},{key:"getHistory",value:function(){return this.dependencies.Services.CityHistoryService.getItems()}}]),r}();exports.default=p;
},{"../framework/appuicontrollercomponent.js":43,"../service/cityhistoryservice.js":41,"./cityinputcontroller.js":29,"../service/favcityservice.js":30}],29:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),n=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,r)}if("value"in i)return i.value;var s=i.get;return void 0!==s?s.call(r):void 0},r=require("./../helper.js"),i=p(r),o=require("../framework/appuicontrollercomponent.js"),s=h(o),l=require("./searchhistorycontroller.js"),u=h(l),a=require("./urlcontroller.js"),c=h(a);function h(e){return e&&e.__esModule?e:{default:e}}function p(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var y=function(r){function o(){d(this,o);var e=v(this,(o.__proto__||Object.getPrototypeOf(o)).call(this));return e.config={},e.dependencies={Services:{CityHistoryService:"CityHistoryService",SettingsService:"SettingsService",WeatherService:"WeatherService"},UiControllers:{WeatherController:"WeatherController",SearchHistoryController:"SearchHistoryController",UrlController:"UrlController"}},e._settings={minChar:3},e}return f(o,s.default),t(o,[{key:"run",value:function(){n(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"run",this).call(this),this.attachClickHandlers()}},{key:"attachClickHandlers",value:function(){this.attachOnClickHandler(this.uiElements.searchAction,this.actionSearch),this.uiElements.textInput.addEventListener("input",this.onUserCharInput.bind(this)),this.uiElements.textInput.addEventListener("keydown",this.onUserSpecialKey.bind(this)),this.uiElements.textInput.addEventListener("focus",this.onUserInputFocus.bind(this)),this.uiElements.textInput.addEventListener("blur",this.onUserInputBlur.bind(this)),this.attachOnClickHandler(this.uiElements.textInput,this.onUserInputClick)}},{key:"actionSearch",value:function(t){var n=this;"object"===(void 0===t?"undefined":e(t))&&t.preventDefault();var r=["current","forecast5"];if(!(this.uiElements.textInput.value.length<this._settings.minChar)){var i=this.uiElements.textInput.value,o=/^[\-\d\s,.]+$/.test(i)?"latlon":"cityname",s={};switch(o){case"cityname":s={q:i};break;case"latlon":var l=i.split(/[\s,]/);s={lon:l[0],lat:l[l.length-1]}}s.units=this.dependencies.Services.SettingsService.units,this.renderForecasts(this.dependencies.Services.WeatherService.apiRequest(r[0],o,s),this.dependencies.Services.WeatherService.apiRequest(r[1],o,s),"cityname"===o).then(function(e){e&&(n.uiElements.textInput.value=e,n.dependencies.Services.CityHistoryService.addEntry({name:e}),"no-url-update"!==t&&n.dependencies.UiControllers.UrlController.updateUrl(encodeURIComponent(e),"actionSearch"))})}}},{key:"focus",value:function(){this.uiElements.textInput.focus()}},{key:"onUserInputClick",value:function(){this.uiElements.textInput.select()}},{key:"setValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];e.length?(this.uiElements.textInput.value=e,e.length>=this._settings.minChar?(this.uiElements.searchAction.disabled=!1,n?(this.uiElements.textInput.blur(),this.uiElements.searchAction.click()):null!==t&&(-1===t&&(t=e.length),i.setCaretPosition(this.uiElements.textInput,t))):this.uiElements.searchAction.disabled=!0):(this.uiElements.textInput.value="",this.uiElements.searchAction.disabled=!0,this.dependencies.UiControllers.SearchHistoryController.show())}},{key:"onUserCharInput",value:function(e){var t=this.uiElements.textInput;t.value.length>0&&/^[\-\d.,]/.test(t.value)&&(t.value=t.value.replace(/[^\-\d.,\s]/g,"")),t.value=i.sanitizeWhitespaces(t.value),this.uiElements.searchAction.disabled=t.value.length<this._settings.minChar,0===t.value.length?this.dependencies.UiControllers.SearchHistoryController.show():this.dependencies.UiControllers.SearchHistoryController.hide()}},{key:"onUserSpecialKey",value:function(e){var t=this;switch(e.keyCode){case 13:this.uiElements.textInput.blur(),this.uiElements.searchAction.click();break;case 27:this.dependencies.UiControllers.SearchHistoryController.hide();break;case 40:this.dependencies.UiControllers.SearchHistoryController.show().then(function(){return t.dependencies.UiControllers.SearchHistoryController.focus()})}}},{key:"onUserInputBlur",value:function(e){var t=this.uiElements.textInput;t.value=i.sanitizeWhitespaces(t.value,!0)}},{key:"onUserInputFocus",value:function(e){0===e.target.value.length&&this.dependencies.UiControllers.SearchHistoryController.show()}},{key:"renderForecasts",value:function(e,t,n){return this.dependencies.UiControllers.WeatherController.renderForecast(t),this.dependencies.UiControllers.WeatherController.renderToday(e,n)}}]),o}();exports.default=y;
},{"./../helper.js":25,"../framework/appuicontrollercomponent.js":43,"./searchhistorycontroller.js":34,"./urlcontroller.js":36}],36:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),t=function e(t,n,o){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,o)}if("value"in r)return r.value;var l=r.get;return void 0!==l?l.call(o):void 0},n=require("./../framework/appcontrollercomponent.js"),o=l(n),r=require("./cityinputcontroller.js"),i=l(r);function l(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var c=function(n){function r(){a(this,r);var e=u(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return e.config={baseUrl:"baseUrl"},e.dependencies={CityInputController:"CityInputController"},e}return s(r,o.default),e(r,[{key:"run",value:function(){t(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"run",this).call(this);var e=this.getCityName();window.addEventListener("popstate",this.onHistoryNavigation.bind(this),!0),this.dependencies.CityInputController&&e&&(this.dependencies.CityInputController.setValue(e,null,!1),this.dependencies.CityInputController.actionSearch())}},{key:"updateUrl",value:function(e,t){this.debugThisClassName("updateUrl("+e+") from "+t);var n=this.config.baseUrl+"?q="+e;console.log(window.location+" -- "+n),window.location!==n&&history.pushState({},document.title+": "+e,n)}},{key:"onHistoryNavigation",value:function(e){var t=this.getCityName();this.debugThisClassName("onHistoryNavigation"),console.log(e.state),this.dependencies.CityInputController&&t&&(this.dependencies.CityInputController.setValue(t,null,!1),this.dependencies.CityInputController.actionSearch("no-url-update"))}},{key:"getCityName",value:function(){var e=new URL(window.location.href).searchParams.get("q");return console.log("Q="+e),e}}]),r}();exports.default=c;
},{"./../framework/appcontrollercomponent.js":26,"./cityinputcontroller.js":29}],35:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),t=require("../framework/appservicecomponent.js"),n=r(t);function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(t){function r(){o(this,r);var e=i(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return e.config={api:"api"},e}return c(r,n.default),e(r,[{key:"apiRequest",value:function(e,t,n){var r=this,o=this.config.api.apiUrl+this.config.api.apiEndpoint[e][t].path+"?";return o+=Object.keys(n).map(function(e){return e+"="+n[e]}).join("&"),o+="&"+this.config.api.apiParamName+"="+this.config.api.apiKey,fetch(o,{method:"get"}).then(function(e){if(e.ok)return e.json();throw e.status}).then(function(t){switch(e){case"current":t.weather[0].verbose=r.decomposeIconId(t.weather[0].icon);break;case"forecast5":t.list.forEach(function(e,n){t.list[n].weather[0].verbose=r.decomposeIconId(t.list[n].weather[0].icon)})}return t}).catch(function(e){throw e})}},{key:"apiRequestIcon",value:function(e){var t=this.apiIconUrl(e);return fetch(t,{method:"get"}).then(function(e){if(e.ok)return e.blob();throw e.status}).then(function(e){return URL.createObjectURL(e)}).catch(function(e){throw e})}},{key:"apiIconUrl",value:function(e){return this.config.api.iconUrl+e+this.config.api.iconExt}},{key:"decomposeIconId",value:function(e){return{tod:"d"===e.substr(2)?"day":"night",conditions:this.verbalizeConditionsCode(e.substr(0,2))}}},{key:"verbalizeConditionsCode",value:function(e){switch(e){case"01":return"clearSky";case"02":return"fewClouds";case"03":return"scatteredClouds";case"04":return"brokenClouds";case"09":return"showerRain";case"10":return"rain";case"11":return"thunderStorm";case"13":return"snow";case"50":return"mist";default:return"unknown"}}}]),r}();exports.default=a;
},{"../framework/appservicecomponent.js":26}],37:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),t=require("../framework/appuicontrollercomponent.js"),n=o(t);function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(t){function o(){r(this,o);var e=i(this,(o.__proto__||Object.getPrototypeOf(o)).call(this));return e.config={mood:"mood"},e.dependencies={},e}return u(o,n.default),e(o,[{key:"run",value:function(){this.renderMood()}},{key:"renderMood",value:function(e,t,n){e||(e=new Date),t||(t=50),n||(n={tod:0,conditions:0});var o=this.getSeason(e,t),r=this.getMoodImage(n.conditions,n.tod,o);this.uiElements.container.style.backgroundImage="url('"+r+"')"}},{key:"getSeason",value:function(e,t){var n=e.getMonth()+1,o=n<4?"winter":n<6?"spring":n<9?"summer":n<12?"autumn":"winter";return t<0&&(o="winter"===o?"summer":"summer"===o?"winter":o),(t>65||t<-60)&&(o="winter"),t<=30&&t>-30&&(o="summer"),o}},{key:"getMoodImage",value:function(e,t,n){return e?("unknown"===e&&(e="clearSky"),this.config.mood.imagery[e][t][n]):this.config.mood.seasons[n]}}]),o}();exports.default=a;
},{"../framework/appuicontrollercomponent.js":43}],38:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),t=function e(t,i,n){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,i);if(void 0===o){var r=Object.getPrototypeOf(t);return null===r?void 0:e(r,i,n)}if("value"in o)return o.value;var u=o.get;return void 0!==u?u.call(n):void 0},i=require("../framework/appuicontrollercomponent.js"),n=o(i);function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var p=function(i){function o(){r(this,o);var e=u(this,(o.__proto__||Object.getPrototypeOf(o)).call(this));return e.config={guide:"guide"},e.playedTips={},e}return a(o,n.default),e(o,[{key:"run",value:function(){var e=this;t(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"run",this).call(this),this.initializePlayList(),Object.keys(this.uiElements).forEach(function(t){tippy(e.uiElements[t],e.config.guide.tipOptions)}),window.setTimeout(function(){e.playTip("userInput")},this.config.guide.onloadDelay)}},{key:"playTip",value:function(e){this.debugThisClassName("renderTip()");var t=this.uiElements[e];t&&(this.playedTips[e]=!0,t._tippy.show(),window.setTimeout(function(){t._tippy.hide()},this.config.guide.exposureDuration))}},{key:"playNextTip",value:function(){var e=this,t=this.config.guide.playOrder.find(function(t){return!e.playedTips[t]});t&&this.playTip(t)}},{key:"initializePlayList",value:function(){var e=this;this.config.guide.playOrder.forEach(function(t){e.playedTips[t]=!1})}}]),o}();exports.default=p;
},{"../framework/appuicontrollercomponent.js":43}],40:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),t=require("../framework/appuicontrollercomponent.js"),n=a(t),i=require("../service/favcityservice.js"),r=a(i),o=require("./cityinputcontroller.js"),s=a(o);function a(e){return e&&e.__esModule?e:{default:e}}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var v=function(t){function i(){l(this,i);var e=c(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return e.dependencies={UiControllers:{CityInputController:"CityInputController"},Services:{FavCityService:"FavCityService"}},e}return u(i,n.default),e(i,[{key:"run",value:function(){this.uiElements.addFavCity.addEventListener("click",this.handleAddFavCity.bind(this)),this.uiElements.removeFavCity.addEventListener("click",this.handleRemoveFavCity.bind(this))}},{key:"checkCityIsFav",value:function(e){var t=this;this.dependencies.Services.FavCityService.getItem(e).then(function(e){e?(t.uiElements.addFavCity.classList.add("display-none"),t.uiElements.removeFavCity.classList.remove("display-none")):(t.uiElements.addFavCity.classList.remove("display-none"),t.uiElements.removeFavCity.classList.add("display-none"))})}},{key:"handleAddFavCity",value:function(e){var t=this;e.preventDefault(),this.dependencies.Services.FavCityService.addEntry({name:this.uiElements.cityFullName.textContent}).then(function(){t.checkCityIsFav(t.uiElements.cityFullName.textContent),t.dependencies.UiControllers.CityInputController.focus()})}},{key:"handleRemoveFavCity",value:function(e){var t=this;e.preventDefault(),this.dependencies.Services.FavCityService.deleteEntry(this.uiElements.cityFullName.textContent).then(function(){t.checkCityIsFav(t.uiElements.cityFullName.textContent),t.dependencies.UiControllers.CityInputController.focus()})}}]),i}();exports.default=v;
},{"../framework/appuicontrollercomponent.js":43,"../service/favcityservice.js":30,"./cityinputcontroller.js":29}],31:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),r=require("./../helper.js"),t=y(r),n=require("../framework/appuicontrollercomponent.js"),o=v(n),i=require("../service/settingsservice.js"),a=v(i),s=require("../service/weatherservice.js"),c=v(s),l=require("./moodcontroller.js"),d=v(l),u=require("./guidecontroller.js"),f=v(u),h=require("./favcitycontroller.js"),p=v(h);function v(e){return e&&e.__esModule?e:{default:e}}function y(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}function w(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function m(e,r){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!r||"object"!=typeof r&&"function"!=typeof r?e:r}function g(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)}var b=function(r){function n(){w(this,n);var e=m(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.config={icons:"icons"},e.dependencies={Services:{SettingsService:"SettingsService",WeatherService:"WeatherService"},UiControllers:{MoodController:"MoodController",GuideController:"GuideController",FavCityController:"FavCityController"}},e._elWeatherToday=null,e}return g(n,o.default),e(n,[{key:"renderToday",value:function(e,r){var n=this;return this.exposeElement("today","Spinner"),e.then(function(e){return(e=n.extractWeatherDataCurrent(e)).windSpeedUnits=n.dependencies.Services.SettingsService.windSpeedUnits,e.date=new Date(1e3*e.dt),e.cityFull=e.geocity+","+e.geocountry,e.geoFull=e.geolon+","+e.geolat,n._elWeatherToday||(n._elWeatherToday=t.objectKeysToHtmlElements(e,"wt-")),e.descrIcon='<i class="wi '+n.getWeatherConditionsIcon(e.verbose.tod,e.verbose.conditions)+'"></i>',e.pressure=Math.round(e.pressure/1013.25*100)/100,Object.keys(e).forEach(function(r){r in n._elWeatherToday&&(n._elWeatherToday[r].innerHTML=e[r])}),n.dependencies.UiControllers.FavCityController.checkCityIsFav(e.cityFull),n.exposeElement("today","Main"),n.dependencies.UiControllers.MoodController.renderMood(e.date,e.geolat,e.verbose),n.dependencies.UiControllers.GuideController.playNextTip(),r?e.geocity+","+e.geocountry:null}).catch(function(e){throw n.exposeElement("today","Error"),n.uiElements.todayError.innerText="No weather data for given location or inexistent location (error code: "+e+")",e})}},{key:"renderForecast",value:function(e){var r=this;this.exposeElement("forecast","Spinner"),this.uiElements.forecastMain.innerHTML="",e.then(function(e){var t=(e=r.extractWeatherDataForecast(e)).weatherSchedule.map(function(e){return'<div class="wf-item '+r.getShadeOfTheTime(e.dtHours)+'"><div class="wf-icon"><i class="wi '+r.getWeatherConditionsIcon(e.verbose.tod,e.verbose.conditions)+'"></i></div><div class="wf-descr">'+e.descr+'</div><div class="wf-temp">'+e.temp+'&deg;</div><div class="wf-time">'+e.dtHours+':00</div><div class="wf-date">'+e.dtDate+"</div></div>"});r.uiElements.forecastMain.innerHTML=t.join(""),r.exposeElement("forecast","Main")}).catch(function(e){r.exposeElement("forecast","Error"),r.uiElements.forecastError.innerText="No forecast data for given location or inexistent location (error code: "+e+")"})}},{key:"extractWeatherDataCurrent",value:function(e){return{dt:e.dt,geocity:e.name,geocountry:e.sys.country,geolat:e.coord.lat,geolon:e.coord.lon,descr:e.weather[0].main,descrDetails:e.weather[0].description,descrIcon:'<img src="'+this.dependencies.Services.WeatherService.apiIconUrl(e.weather[0].icon)+'" />',verbose:e.weather[0].verbose,temp:Math.round(e.main.temp),pressure:Math.round(e.main.pressure),humidity:e.main.humidity,windSpeed:Math.round(e.wind.speed),windAzimuth:this.degree2arrow("deg"in e.wind?Math.round(e.wind.deg):null),clouds:e.clouds.all}}},{key:"extractWeatherDataForecast",value:function(e){var r=this,t={geocity:e.city.name,geocountry:e.city.country,geolat:e.city.coord.lat,geolon:e.city.coord.lon},n=e.list.filter(function(e){var r=e.dt_txt.substring(11,13);return"03"===r||"09"===r||"15"===r||"21"===r});return n.sort(function(e,r){return e.dt-r.dt}),t.weatherSchedule=n.map(function(e){return{dtDate:e.dt_txt.substring(8,10)+"/"+e.dt_txt.substring(5,7),dtHours:e.dt_txt.substring(11,13),descr:e.weather[0].main,descrDetails:e.weather[0].description,descrIcon:'<img src="'+r.dependencies.Services.WeatherService.apiIconUrl(e.weather[0].icon)+'" />',verbose:e.weather[0].verbose,temp:Math.round(e.main.temp),pressure:Math.round(e.main.pressure),humidity:e.main.humidity,windSpeed:Math.round(e.wind.speed),windAzimuth:r.degree2arrow("deg"in e.wind?Math.round(e.wind.deg):null),clouds:e.clouds.all}}),t}},{key:"degree2arrow",value:function(e){if(null===e)return"";e%=360;var r={0:"uarr",22:"nearr",67:"rarr",112:"searr",157:"darr",202:"swarr",247:"larr",292:"nwarr",337:"uarr"};return"&"+Object.keys(r).reduce(function(t,n){return e>=n?r[n]:t},"")+";"}},{key:"exposeElement",value:function(e,r){var t=this;r=r.charAt(0).toUpperCase()+r.slice(1),["Main","Debug","Error","Spinner"].forEach(function(n){var o=t.uiElements[e+n];n===r?o.classList.add("weather-visible"):o.classList.remove("weather-visible")})}},{key:"getWeatherConditionsIcon",value:function(e,r){return e||(e="day"),("unknown"===r||Math.floor(41*Math.random())>39)&&(r="alien"),this.config.icons[e][r]}},{key:"getShadeOfTheTime",value:function(e){return e<"01"?"wf-dark":e<"04"?"wf-darkest":e<"07"?"wf-dark":e<"10"?"wf-neutral":e<"13"?"wf-light":e<"16"?"wf-lightest":e<"19"?"wf-light":e<"22"?"wf-neutral":"wf-dark"}}]),n}();exports.default=b;
},{"./../helper.js":25,"../framework/appuicontrollercomponent.js":43,"../service/settingsservice.js":32,"../service/weatherservice.js":35,"./moodcontroller.js":37,"./guidecontroller.js":38,"./favcitycontroller.js":40}],39:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),t=function e(t,r,n){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,r);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,r,n)}if("value"in o)return o.value;var c=o.get;return void 0!==c?c.call(n):void 0},r=require("../framework/appservicecomponent.js"),n=c(r),o=require("./storageservice.js"),i=c(o);function c(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(r){function o(){u(this,o);var e=a(this,(o.__proto__||Object.getPrototypeOf(o)).call(this));return e.config={baseUrl:"baseUrl",cityList:"cityList"},e.dependencies={Services:{StorageService:"StorageService"}},e._storeName="cities",e}return s(o,n.default),e(o,[{key:"run",value:function(){t(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"run",this).call(this),this.updateStorage()}},{key:"updateStorage",value:function(){var e=this;this.dependencies.Services.StorageService.storeCount(this._storeName).then(function(t){t||e.loadSource().then(function(t){console.log(t.length+" entries in the city list.");t=t.slice(0,1234),e.dependencies.Services.StorageService.put(e._storeName,t).then(function(){return console.log("idb.cities updated."),t.length}).then(function(e){console.log("CityListService.updateStorage(cities).count=="+e)})}).catch(function(e){console.log(e)})})}},{key:"loadSource",value:function(){var e=this;return fetch(this.config.baseUrl+this.config.cityList,{method:"get"}).then(function(t){if(e.debugThisClassName("loadSource"),t.ok){var r=t.headers.get("content-type");if(r&&r.includes("application/json"))return t.json();throw new TypeError("JSON expected, "+r+" instead arrived")}throw new Error("Network response was not ok:"+t.error)}).then(function(e){return e.map(function(e){return{id:e.id,name:e.name+", "+e.country,nameUC:(e.name+","+e.country).toUpperCase()}}).filter(function(e){return/^[^\d\W]/.test(e.name)}).sort(function(e,t){return e.nameUC<t.nameUC?-1:1})}).catch(function(e){throw console.log(e),new Error(e)})}}]),o}();exports.default=l;
},{"../framework/appservicecomponent.js":26,"./storageservice.js":33}],24:[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),t=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var s=o.get;return void 0!==s?s.call(r):void 0},n=require("./../framework/appcontrollercomponent.js"),r=x(n),o=require("../helper.js"),i=require("./unitswitchcontroller.js"),s=x(i),c=require("./urlcontroller.js"),l=x(c),u=require("./progresscontroller.js"),a=x(u),f=require("./cityinputcontroller.js"),d=x(f),p=require("./searchhistorycontroller.js"),v=x(p),h=require("./weathercontroller.js"),y=x(h),C=require("../service/cityhistoryservice.js"),j=x(C),b=require("../service/citylistservice.js"),g=x(b),w=require("../service/favcityservice.js"),O=x(w),m=require("../service/settingsservice.js"),E=x(m),q=require("../service/storageservice.js"),S=x(q),U=require("../service/weatherservice.js"),k=x(U),_=require("./moodcontroller.js"),P=x(_),R=require("./guidecontroller.js"),T=x(R),A=require("./favcitycontroller.js"),D=x(A);function x(e){return e&&e.__esModule?e:{default:e}}function F(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function M(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function H(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var I=function(n){function i(e){F(this,i);var t=M(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return t.setConfig(e),t.createComponents(),t.feedConfigToComponents(),t.findUiElements(),t.feedUiElementsToUiControllers(),t.bindDependencies(),t}return H(i,r.default),e(i,[{key:"runRoot",value:function(){var e=this;t(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"runRoot",this).call(this),Object.keys(this.dependencies.Services).forEach(function(t,n){e.dependencies.Services[t].runRoot()}),Object.keys(this.dependencies.Controllers).forEach(function(t,n){e.dependencies.Controllers[t].runRoot()}),Object.keys(this.dependencies.UiControllers).forEach(function(t,n){e.dependencies.UiControllers[t].runRoot()}),this.run()}},{key:"run",value:function(){var e=this;Object.keys(this.dependencies.Services).forEach(function(t,n){e.dependencies.Services[t].run()}),Object.keys(this.dependencies.Controllers).forEach(function(t,n){e.dependencies.Controllers[t].run()}),Object.keys(this.dependencies.UiControllers).forEach(function(t,n){e.dependencies.UiControllers[t].run()})}},{key:"createComponents",value:function(){this.setDependencies({Services:{CityHistoryService:new j.default,CityListService:new g.default,FavCityService:new O.default,SettingsService:new E.default,StorageService:new S.default,WeatherService:new k.default},Controllers:{UrlController:new l.default},UiControllers:{UnitSwitchController:new s.default,ProgressController:new a.default,CityInputController:new d.default,SearchHistoryController:new v.default,WeatherController:new y.default,MoodController:new P.default,GuideController:new T.default,FavCityController:new D.default}})}},{key:"feedConfigToComponents",value:function(){var e=this;(0,o.traverseObjectAndChange)(this.dependencies,function(t){t.config=(0,o.traverseObjectAndChange)(t.config,function(t){return e.config.config[t]})})}},{key:"findUiElements",value:function(){this.config.uiElements=(0,o.traverseObjectAndChange)(this.config.uiElements,function(e){return document.getElementById(e)})}},{key:"feedUiElementsToUiControllers",value:function(){var e=this;Object.keys(this.dependencies.UiControllers).forEach(function(t,n){e.dependencies.UiControllers[t].setUiElements(e.config.uiElements[t])})}},{key:"bindDependencies",value:function(){var e=Object.assign({},this.dependencies.Services,this.dependencies.Controllers,this.dependencies.UiControllers);(0,o.traverseObjectAndChange)(this.dependencies,function(t){t.dependencies=(0,o.traverseObjectAndChange)(t.dependencies,function(t){return e[t]})})}}]),i}();exports.default=I;
},{"./../framework/appcontrollercomponent.js":26,"../helper.js":25,"./unitswitchcontroller.js":27,"./urlcontroller.js":36,"./progresscontroller.js":28,"./cityinputcontroller.js":29,"./searchhistorycontroller.js":34,"./weathercontroller.js":31,"../service/cityhistoryservice.js":41,"../service/citylistservice.js":39,"../service/favcityservice.js":30,"../service/settingsservice.js":32,"../service/storageservice.js":33,"../service/weatherservice.js":35,"./moodcontroller.js":37,"./guidecontroller.js":38,"./favcitycontroller.js":40}],7:[function(require,module,exports) {
"use strict";var e=require("./config.js"),r=require("./controller/appcontroller.js"),o=n(r);function n(e){return e&&e.__esModule?e:{default:e}}var l=new o.default(e.appConfig);l.runRoot(),console.log("App ready");
},{"./config.js":23,"./controller/appcontroller.js":24}]},{},[7])